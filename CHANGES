Complete change log for the Pilot 1
-----------------------------------


71.0

General changes:
- Remover deprecated function updateCmd1WithProject() (ATLASExperiment)
- Corrected overwriting of bad cpuConsumptionTime in BOINC jobs in getNodeStructure() (PandaServerClient)
- Added back missing taskid in the tracing report (movers/trace_report)
- Corrected timeGetJob, removed code from wrong place (pilot, Monitor)
- Fixed bug where local file was not deleted after partial stage-in, in _stagefile() (lsm_sitemover)
- Now killing job if used memory > 2*RSS for all sites (before only on non-cgroups sites), in __check_memory_usage() (Monitor)

Containers
- Updated extractSingularityOptions() to use container_options field instead of catchall, if it exists (Singularity)
- Created getContainerName() (Singularity)

LAN/WAN updates:
- Created detect_client_location() and printing out the dictionary in the log (pilot)
- Using new version of list_replicas() if possible, that supports geoip sorting, resolve_replicas() (mover)

Event service:
- Added support for new job def variable usePrefetcher in setJobDef() (Job)
- Renamed variable prefetcher to usePrefetcher (Job, RunJobEvent)
- Updated setUsePrefetcher() to use new usePrefetcher variable (RunJobEvent)

Updates from Wen Guan:

  https://github.com/PanDAWMS/pilot/pull/162

Commit Summary

refactored objectstore sitemover
added option to disable logsToOS
fixed one issue

File Changes

M ATLASExperiment.py (2)
M RunJobEvent.py (2)
M movers/objectstore_sitemover.py (70)

Updates from Alexey Anisenkov

  https://github.com/PanDAWMS/pilot/pull/164

Updates of sitemovers stage-out workflow:

- Skip removal of remote file if given file already exists at storage
- Try to continue stageout step of file validation by checksum/filesize if given file already exists in storage.
  In case of validation error fail stageout with FILEEXIST error
- Skip further transfer attempts in case of file exists error
- Fixed typo bug in processes.py (undefined variable)

Commit Summary

stageout workflow updates:
fixed typo bug in process.py (undefined variable)
stage-out fixes
sitemovers: add verbose message

File Changes

M movers/base.py (36)
M movers/mover.py (5)
M processes.py (11)

  https://github.com/PanDAWMS/pilot/pull/165

Commit Summary

Fixed logic in look-up of default copytool: consider only copytools explicitly defined for all activities

File Changes

M SiteInformation.py (12)

  https://github.com/PanDAWMS/pilot/pull/166

Commit Summary

JobMover: extend stage-out logic to support ordered list of activities to look up sitemovers to be used for transfer.

File Changes

M SiteInformation.py (11)
M movers/mover.py (13)

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

71.1

General changes:
- Now using TURLs for input in payload options when Prefetcher is used (RunJobEvent)

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


TODO:

todo: remove the explicit usages of schedconfig.lfchost and replace with an experiment specific method (getFileCatalog())
todo: rename pUtil.getExperiment to pUtil.getExperimentObject, correct import in SiteInformation

#### add new error codes 1217-1219 to proddb
Update prodDB for ERR_RUNJOBEXC : "Exception caught by runJob" -> "Exception caught by RunJob*" ? not necessary??
Added new error codes; 1224 (ERR_ESRECOVERABLE), 1225 (ERR_ESMERGERECOVERABLE) (PilotErrors)
